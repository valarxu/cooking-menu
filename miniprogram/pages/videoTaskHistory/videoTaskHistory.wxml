<view class="container">
  <view class="page-title">å†å²ç”Ÿæˆè®°å½•</view>
  
  <view class="content {{videoTasks.length === 0 ? 'empty' : ''}}">
    <!-- ä»»åŠ¡çŠ¶æ€æ˜¾ç¤ºåŒºåŸŸ -->
    <view class="task-status-section" wx:if="{{videoTasks.length > 0}}">
      <view class="section-header">
        <text class="section-title">è§†é¢‘ç”Ÿæˆä»»åŠ¡</text>
        <button class="refresh-btn" bindtap="refreshTaskStatus" size="mini">åˆ·æ–°çŠ¶æ€</button>
      </view>
      
      <view class="task-list">
        <view class="task-item" wx:for="{{videoTasks}}" wx:key="_id">
          <view class="task-header">
            <text class="task-time">{{item.created_at}}</text>
            <view class="task-status-wrapper">
              <text class="task-status {{item.status}}">{{item.status === 'completed' ? 'å·²å®Œæˆ' : item.status === 'processing' ? 'ç”Ÿæˆä¸­' : 'è¿›è¡Œä¸­'}}</text>
              <text class="task-progress" wx:if="{{item.status === 'processing'}}">{{item.completed_tasks || 0}}/{{item.total_tasks || 0}}</text>
            </view>
          </view>
          
          <!-- è¿›åº¦æ¡ -->
          <view class="progress-bar" wx:if="{{item.status === 'processing'}}">
            <view class="progress-fill" style="width: {{item.progress || 0}}%"></view>
          </view>
          
          <view class="audio-results">
            <view class="audio-item" wx:for="{{item.audio_results}}" wx:for-item="audio" wx:key="taskId">
              <view class="audio-info">
                <text class="audio-type">{{audio.type}}</text>
                <text class="audio-text">{{audio.text}}</text>
              </view>
              <view class="audio-status">
                <text class="status-text {{audio.status}}">
                  {{audio.status === 'completed' ? 'âœ“' : audio.status === 'pending' ? 'â³' : audio.status === 'processing' ? 'ğŸ”„' : 'âœ—'}}
                </text>
                <button wx:if="{{audio.audioUrl}}" class="play-audio-btn" data-url="{{audio.audioUrl}}" bindtap="playGeneratedAudio" size="mini">æ’­æ”¾</button>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:else>
      <image src="/images/empty-product.png" class="empty-icon" mode="aspectFit"></image>
      <view class="empty-text">æš‚æ— ç”Ÿæˆè®°å½•</view>
      <view class="empty-desc">æ‚¨è¿˜æ²¡æœ‰åˆ›å»ºè¿‡è§†é¢‘ç”Ÿæˆä»»åŠ¡</view>
    </view>
  </view>
</view>